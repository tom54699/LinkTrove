# Capability: Card Templates

## Purpose
æä¾›å¡ç‰‡æ¨¡æ¿åŠŸèƒ½ï¼Œè®“ä½¿ç”¨è€…å¯ä»¥é å…ˆå®šç¾©å¸¸ç”¨å¡ç‰‡æ ¼å¼ï¼ˆæ¨™é¡Œã€URLã€faviconã€å‚™è¨»ï¼‰ï¼Œä¸¦å¿«é€Ÿæ–°å¢åˆ°ç¾¤çµ„ä¸­ã€‚æ”¯æ´æ¨¡æ¿è®Šæ•¸ï¼ˆæ—¥æœŸã€æ™‚é–“ã€è¨ˆæ•¸å™¨ï¼‰å‹•æ…‹ç”Ÿæˆå…§å®¹ã€‚

## Requirements

### Requirement: å»ºç«‹å¡ç‰‡æ¨¡æ¿
ç³»çµ±å¿…é ˆï¼ˆSHALLï¼‰æ”¯æ´ä½¿ç”¨è€…å»ºç«‹è‡ªè¨‚å¡ç‰‡æ¨¡æ¿ï¼ŒåŒ…å«æ¨™é¡Œã€URLã€favicon å’Œå‚™è¨»æ¬„ä½ã€‚

#### Scenario: å»ºç«‹åŸºæœ¬æ¨¡æ¿
- **WHEN** ä½¿ç”¨è€…é»æ“Šã€Œå»ºç«‹æ¨¡æ¿ã€æŒ‰éˆ•
- **THEN** ç³»çµ±é¡¯ç¤ºæ¨¡æ¿ç·¨è¼¯å°è©±æ¡†ï¼ŒåŒ…å«ä»¥ä¸‹æ¬„ä½ï¼š
  - æ¨¡æ¿åç¨±ï¼ˆå¿…å¡«ï¼‰
  - æ¨™é¡Œï¼ˆé¸å¡«ï¼Œæ”¯æ´è®Šæ•¸ï¼‰
  - URLï¼ˆé¸å¡«ï¼Œæ”¯æ´è®Šæ•¸ï¼‰
  - Favicon URLï¼ˆé¸å¡«ï¼‰
  - å‚™è¨»ï¼ˆé¸å¡«ï¼Œæ”¯æ´è®Šæ•¸ï¼‰
- **WHEN** ä½¿ç”¨è€…å¡«å¯«æ¨¡æ¿è³‡è¨Šä¸¦å„²å­˜
- **THEN** ç³»çµ±ç”¢ç”Ÿæ¨¡æ¿ IDï¼ˆæ ¼å¼ï¼š`t_[timestamp]`ï¼‰
- **THEN** ç³»çµ±å°‡æ¨¡æ¿å¯«å…¥ IndexedDB çš„ `templates` store
- **THEN** æ¨¡æ¿å‡ºç¾åœ¨æ¨¡æ¿åˆ—è¡¨ä¸­

#### Scenario: æ¨¡æ¿æ¬„ä½é©—è­‰
- **GIVEN** ä½¿ç”¨è€…æ­£åœ¨å»ºç«‹æ¨¡æ¿
- **WHEN** ä½¿ç”¨è€…æœªå¡«å¯«æ¨¡æ¿åç¨±
- **THEN** ç³»çµ±é¡¯ç¤ºé©—è­‰éŒ¯èª¤ï¼šã€Œæ¨¡æ¿åç¨±ç‚ºå¿…å¡«æ¬„ä½ã€
- **THEN** ç„¡æ³•å„²å­˜æ¨¡æ¿

#### Scenario: è¨­å®šæ¨¡æ¿åœ–ç¤º
- **GIVEN** ä½¿ç”¨è€…æ­£åœ¨å»ºç«‹æ¨¡æ¿
- **WHEN** ä½¿ç”¨è€…è¼¸å…¥ Favicon URLï¼ˆä¾‹å¦‚ï¼š`https://example.com/icon.png`ï¼‰
- **THEN** ç³»çµ±é è¦½è©²åœ–ç¤º
- **WHEN** ä½¿ç”¨è€…æœªè¼¸å…¥ Favicon URL
- **THEN** ç³»çµ±ä½¿ç”¨é è¨­æ¨¡æ¿åœ–ç¤ºï¼ˆğŸ“„ï¼‰

#### Scenario: æ¨¡æ¿å„²å­˜åˆ° IndexedDB
- **GIVEN** ä½¿ç”¨è€…å»ºç«‹æ¨¡æ¿ "æ¯æ—¥ç­†è¨˜"
- **WHEN** ä½¿ç”¨è€…å„²å­˜æ¨¡æ¿
- **THEN** ç³»çµ±å»ºç«‹ TemplateData è¨˜éŒ„ï¼š
  ```json
  {
    "id": "t_1704614400000",
    "name": "æ¯æ—¥ç­†è¨˜",
    "title": "{{date}} - æ¯æ—¥ç­†è¨˜",
    "url": "https://notion.so/daily-{{date}}",
    "favicon": "https://notion.so/icon.png",
    "note": "å»ºç«‹æ™‚é–“ï¼š{{datetime}}",
    "order": 0,
    "createdAt": "2026-01-07T12:00:00Z",
    "updatedAt": "2026-01-07T12:00:00Z"
  }
  ```
- **THEN** å¯«å…¥ IndexedDB çš„ `templates` store

### Requirement: æ¨¡æ¿è®Šæ•¸æ”¯æ´
ç³»çµ±å¿…é ˆï¼ˆSHALLï¼‰æ”¯æ´åœ¨æ¨¡æ¿ä¸­ä½¿ç”¨è®Šæ•¸ï¼Œä¸¦åœ¨å»ºç«‹å¡ç‰‡æ™‚å‹•æ…‹æ›¿æ›ã€‚

#### Scenario: æ—¥æœŸè®Šæ•¸æ›¿æ›
- **GIVEN** æ¨¡æ¿æ¨™é¡Œç‚º "ç­†è¨˜ - {{date}}"
- **WHEN** ä½¿ç”¨è€…å¾è©²æ¨¡æ¿å»ºç«‹å¡ç‰‡ï¼ˆ2026-01-07ï¼‰
- **THEN** ç³»çµ±å°‡ `{{date}}` æ›¿æ›ç‚º "2026-01-07"
- **THEN** å¡ç‰‡æ¨™é¡Œç‚º "ç­†è¨˜ - 2026-01-07"

#### Scenario: æ—¥æœŸæ™‚é–“è®Šæ•¸æ›¿æ›
- **GIVEN** æ¨¡æ¿å‚™è¨»ç‚º "å»ºç«‹æ™‚é–“ï¼š{{datetime}}"
- **WHEN** ä½¿ç”¨è€…å¾è©²æ¨¡æ¿å»ºç«‹å¡ç‰‡ï¼ˆ2026-01-07 14:30:00ï¼‰
- **THEN** ç³»çµ±å°‡ `{{datetime}}` æ›¿æ›ç‚º "2026-01-07 14:30:00"
- **THEN** å¡ç‰‡å‚™è¨»ç‚º "å»ºç«‹æ™‚é–“ï¼š2026-01-07 14:30:00"

#### Scenario: è¨ˆæ•¸å™¨è®Šæ•¸æ›¿æ›
- **GIVEN** æ¨¡æ¿æ¨™é¡Œç‚º "ä»»å‹™ #{{counter}}"
- **GIVEN** è©²æ¨¡æ¿å·²å»ºç«‹ 3 å¼µå¡ç‰‡
- **WHEN** ä½¿ç”¨è€…å†æ¬¡å¾è©²æ¨¡æ¿å»ºç«‹å¡ç‰‡
- **THEN** ç³»çµ±å°‡ `{{counter}}` æ›¿æ›ç‚º "4"ï¼ˆè‡ªå‹•éå¢ï¼‰
- **THEN** å¡ç‰‡æ¨™é¡Œç‚º "ä»»å‹™ #4"
- **THEN** æ¨¡æ¿çš„è¨ˆæ•¸å™¨æ›´æ–°ç‚º 4

#### Scenario: è‡ªè¨‚æ—¥æœŸæ ¼å¼
- **GIVEN** æ¨¡æ¿æ¨™é¡Œç‚º "æœƒè­°è¨˜éŒ„ {{date:YYYY/MM/DD}}"
- **WHEN** ä½¿ç”¨è€…å¾è©²æ¨¡æ¿å»ºç«‹å¡ç‰‡ï¼ˆ2026-01-07ï¼‰
- **THEN** ç³»çµ±æŒ‰æŒ‡å®šæ ¼å¼æ›¿æ›ï¼š`{{date:YYYY/MM/DD}}` â†’ "2026/01/07"
- **THEN** å¡ç‰‡æ¨™é¡Œç‚º "æœƒè­°è¨˜éŒ„ 2026/01/07"

#### Scenario: å¤šå€‹è®Šæ•¸çµ„åˆ
- **GIVEN** æ¨¡æ¿æ¨™é¡Œç‚º "æœƒè­° #{{counter}} - {{date}}"
- **GIVEN** æ¨¡æ¿ URL ç‚º "https://notes.com/meeting-{{date}}-{{counter}}"
- **WHEN** ä½¿ç”¨è€…å»ºç«‹å¡ç‰‡ï¼ˆ2026-01-07ï¼Œè¨ˆæ•¸å™¨: 5ï¼‰
- **THEN** å¡ç‰‡æ¨™é¡Œç‚º "æœƒè­° #5 - 2026-01-07"
- **THEN** å¡ç‰‡ URL ç‚º "https://notes.com/meeting-2026-01-07-5"

#### Scenario: ä¸å­˜åœ¨çš„è®Šæ•¸ä¿æŒåŸæ¨£
- **GIVEN** æ¨¡æ¿æ¨™é¡Œç‚º "ç­†è¨˜ - {{unknown}}"
- **WHEN** ä½¿ç”¨è€…å»ºç«‹å¡ç‰‡
- **THEN** ç³»çµ±ä¿ç•™æœªçŸ¥è®Šæ•¸ï¼šå¡ç‰‡æ¨™é¡Œç‚º "ç­†è¨˜ - {{unknown}}"
- **THEN** è¨˜éŒ„è­¦å‘Šåˆ° consoleï¼šã€ŒæœªçŸ¥è®Šæ•¸: {{unknown}}ã€

### Requirement: å¿«é€Ÿæ–°å¢æ¨¡æ¿å¡ç‰‡
ç³»çµ±å¿…é ˆï¼ˆSHALLï¼‰æ”¯æ´å¾æ¨¡æ¿å¿«é€Ÿå»ºç«‹å¡ç‰‡ï¼Œä¸¦åŠ å…¥æŒ‡å®šç¾¤çµ„ã€‚

#### Scenario: å¾æ¨¡æ¿å»ºç«‹å–®å¼µå¡ç‰‡
- **GIVEN** ä½¿ç”¨è€…åœ¨ç¾¤çµ„ G çš„ç®¡ç†ä»‹é¢
- **WHEN** ä½¿ç”¨è€…é»æ“Šã€Œå¾æ¨¡æ¿æ–°å¢ã€æŒ‰éˆ•
- **THEN** ç³»çµ±é¡¯ç¤ºæ¨¡æ¿åˆ—è¡¨ï¼ˆæ‰€æœ‰å¯ç”¨æ¨¡æ¿ï¼‰
- **WHEN** ä½¿ç”¨è€…é¸æ“‡æ¨¡æ¿ T
- **THEN** ç³»çµ±æ›¿æ›æ¨¡æ¿è®Šæ•¸ç”Ÿæˆå¡ç‰‡è³‡æ–™
- **THEN** ç³»çµ±å»ºç«‹æ–°å¡ç‰‡ä¸¦åŠ å…¥ç¾¤çµ„ G
- **THEN** å¡ç‰‡é¡¯ç¤ºåœ¨ç¾¤çµ„ G çš„æœ«å°¾
- **THEN** é¡¯ç¤ºæˆåŠŸè¨Šæ¯ï¼šã€Œå·²å¾æ¨¡æ¿ [æ¨¡æ¿åç¨±] å»ºç«‹å¡ç‰‡ã€

#### Scenario: å»ºç«‹å¡ç‰‡æ™‚ç¢ºèªå…§å®¹
- **GIVEN** ä½¿ç”¨è€…é¸æ“‡æ¨¡æ¿ T
- **WHEN** ç³»çµ±æ›¿æ›è®Šæ•¸å¾Œ
- **THEN** ç³»çµ±é¡¯ç¤ºé è¦½å°è©±æ¡†ï¼š
  - æ¨™é¡Œï¼š[æ›¿æ›å¾Œçš„æ¨™é¡Œ]
  - URLï¼š[æ›¿æ›å¾Œçš„ URL]
  - å‚™è¨»ï¼š[æ›¿æ›å¾Œçš„å‚™è¨»]
  - [ç·¨è¼¯] [ç¢ºèª] [å–æ¶ˆ] æŒ‰éˆ•
- **WHEN** ä½¿ç”¨è€…é»æ“Šã€Œç¢ºèªã€
- **THEN** ç³»çµ±å»ºç«‹å¡ç‰‡
- **WHEN** ä½¿ç”¨è€…é»æ“Šã€Œç·¨è¼¯ã€
- **THEN** å…è¨±ä½¿ç”¨è€…ä¿®æ”¹å…§å®¹å†å»ºç«‹

#### Scenario: æ‰¹æ¬¡å»ºç«‹å¤šå¼µæ¨¡æ¿å¡ç‰‡
- **GIVEN** ä½¿ç”¨è€…é¸æ“‡æ¨¡æ¿ T
- **WHEN** ä½¿ç”¨è€…è¼¸å…¥å»ºç«‹æ•¸é‡ 5
- **THEN** ç³»çµ±å»ºç«‹ 5 å¼µå¡ç‰‡ï¼ˆè¨ˆæ•¸å™¨è‡ªå‹•éå¢ï¼‰
- **THEN** 5 å¼µå¡ç‰‡ä¾åºåŠ å…¥ç¾¤çµ„ G
- **THEN** é¡¯ç¤ºæˆåŠŸè¨Šæ¯ï¼šã€Œå·²å»ºç«‹ 5 å¼µå¡ç‰‡ã€

#### Scenario: å»ºç«‹æ™‚é¸æ“‡ç›®æ¨™ç¾¤çµ„
- **GIVEN** ä½¿ç”¨è€…é»æ“Šé ‚å±¤ã€Œå¾æ¨¡æ¿æ–°å¢ã€æŒ‰éˆ•ï¼ˆéç¾¤çµ„å…§ï¼‰
- **WHEN** ä½¿ç”¨è€…é¸æ“‡æ¨¡æ¿ T
- **THEN** ç³»çµ±é¡¯ç¤ºã€Œé¸æ“‡ç¾¤çµ„ã€å°è©±æ¡†
- **WHEN** ä½¿ç”¨è€…é¸æ“‡ç¾¤çµ„ G
- **THEN** ç³»çµ±å»ºç«‹å¡ç‰‡ä¸¦åŠ å…¥ç¾¤çµ„ G

### Requirement: æ¨¡æ¿ç®¡ç†
ç³»çµ±å¿…é ˆï¼ˆSHALLï¼‰æä¾›å®Œæ•´çš„æ¨¡æ¿ç®¡ç†åŠŸèƒ½ï¼ŒåŒ…å«ç·¨è¼¯ã€åˆªé™¤ã€æ’åºå’Œæœå°‹ã€‚

#### Scenario: ç·¨è¼¯ç¾æœ‰æ¨¡æ¿
- **GIVEN** æ¨¡æ¿åˆ—è¡¨é¡¯ç¤ºæ¨¡æ¿ T
- **WHEN** ä½¿ç”¨è€…é»æ“Šæ¨¡æ¿ T çš„ã€Œç·¨è¼¯ã€æŒ‰éˆ•
- **THEN** ç³»çµ±é¡¯ç¤ºæ¨¡æ¿ç·¨è¼¯å°è©±æ¡†ï¼Œé å¡«ç¾æœ‰è³‡æ–™
- **WHEN** ä½¿ç”¨è€…ä¿®æ”¹æ¨¡æ¿åç¨±æˆ–æ¬„ä½
- **THEN** ç³»çµ±æ›´æ–° IndexedDB ä¸­çš„æ¨¡æ¿è¨˜éŒ„
- **THEN** æ¨¡æ¿çš„ `updatedAt` æ™‚é–“æˆ³æ›´æ–°
- **THEN** é¡¯ç¤ºæˆåŠŸè¨Šæ¯ï¼šã€Œæ¨¡æ¿å·²æ›´æ–°ã€

#### Scenario: åˆªé™¤æ¨¡æ¿
- **GIVEN** æ¨¡æ¿åˆ—è¡¨é¡¯ç¤ºæ¨¡æ¿ T
- **WHEN** ä½¿ç”¨è€…é»æ“Šæ¨¡æ¿ T çš„ã€Œåˆªé™¤ã€æŒ‰éˆ•
- **THEN** ç³»çµ±é¡¯ç¤ºç¢ºèªå°è©±æ¡†ï¼šã€Œç¢ºå®šè¦åˆªé™¤æ¨¡æ¿ [æ¨¡æ¿åç¨±]ï¼Ÿã€
- **WHEN** ä½¿ç”¨è€…ç¢ºèªåˆªé™¤
- **THEN** ç³»çµ±å¾ IndexedDB çš„ `templates` store åˆªé™¤è©²æ¨¡æ¿
- **THEN** æ¨¡æ¿å¾åˆ—è¡¨ä¸­ç§»é™¤
- **THEN** é¡¯ç¤ºæˆåŠŸè¨Šæ¯ï¼šã€Œæ¨¡æ¿å·²åˆªé™¤ã€

#### Scenario: åˆªé™¤æ¨¡æ¿ä¸å½±éŸ¿å·²å»ºç«‹çš„å¡ç‰‡
- **GIVEN** ä½¿ç”¨è€…å¾æ¨¡æ¿ T å»ºç«‹äº† 10 å¼µå¡ç‰‡
- **WHEN** ä½¿ç”¨è€…åˆªé™¤æ¨¡æ¿ T
- **THEN** 10 å¼µå·²å»ºç«‹çš„å¡ç‰‡ä¿æŒä¸è®Š
- **THEN** å¡ç‰‡ä¸åŒ…å«æ¨¡æ¿ ID åƒç…§ï¼ˆç¨ç«‹å­˜åœ¨ï¼‰

#### Scenario: æ‹–æ”¾èª¿æ•´æ¨¡æ¿é †åº
- **GIVEN** æ¨¡æ¿åˆ—è¡¨é¡¯ç¤º 5 å€‹æ¨¡æ¿
- **WHEN** ä½¿ç”¨è€…æ‹–å‹•æ¨¡æ¿ T3 åˆ°æ¨¡æ¿ T1 ä¸Šæ–¹
- **THEN** æ¨¡æ¿é †åºè®Šç‚º [T3, T1, T2, T4, T5]
- **THEN** ç³»çµ±æ›´æ–°æ¯å€‹æ¨¡æ¿çš„ `order` æ¬„ä½
- **THEN** é †åºæŒä¹…åŒ–åˆ° IndexedDB

#### Scenario: æœå°‹æ¨¡æ¿
- **GIVEN** ä½¿ç”¨è€…æœ‰ 20 å€‹æ¨¡æ¿
- **WHEN** ä½¿ç”¨è€…åœ¨æœå°‹æ¡†è¼¸å…¥ "ç­†è¨˜"
- **THEN** æ¨¡æ¿åˆ—è¡¨åªé¡¯ç¤ºåç¨±åŒ…å« "ç­†è¨˜" çš„æ¨¡æ¿
- **THEN** åŒ¹é…çš„é—œéµå­—é«˜äº®é¡¯ç¤º

#### Scenario: åŒ¯å‡º/åŒ¯å…¥æ¨¡æ¿
- **WHEN** ä½¿ç”¨è€…é»æ“Šã€ŒåŒ¯å‡ºæ¨¡æ¿ã€æŒ‰éˆ•
- **THEN** ç³»çµ±ç”¢ç”ŸåŒ…å«æ‰€æœ‰æ¨¡æ¿çš„ JSON æª”æ¡ˆ
- **THEN** ä¸‹è¼‰æª”æ¡ˆå‘½åç‚º `linktrove-templates-[timestamp].json`
- **WHEN** ä½¿ç”¨è€…åŒ¯å…¥æ¨¡æ¿ JSON æª”æ¡ˆ
- **THEN** ç³»çµ±è§£æä¸¦é©—è­‰æª”æ¡ˆæ ¼å¼
- **THEN** ç³»çµ±å°‡æ¨¡æ¿å¯«å…¥ IndexedDBï¼ˆè™•ç† ID è¡çªï¼‰
- **THEN** é¡¯ç¤ºæˆåŠŸè¨Šæ¯ï¼šã€Œå·²åŒ¯å…¥ [æ•¸é‡] å€‹æ¨¡æ¿ã€

### Requirement: é è¨­æ¨¡æ¿
ç³»çµ±å¿…é ˆï¼ˆSHALLï¼‰æä¾›ä¸€çµ„é è¨­æ¨¡æ¿ï¼Œå¹«åŠ©æ–°ä½¿ç”¨è€…å¿«é€Ÿä¸Šæ‰‹ã€‚

#### Scenario: é¦–æ¬¡å•Ÿå‹•æ™‚å»ºç«‹é è¨­æ¨¡æ¿
- **GIVEN** ä½¿ç”¨è€…é¦–æ¬¡å®‰è£ LinkTrove
- **WHEN** æ‡‰ç”¨ç¨‹å¼å•Ÿå‹•
- **THEN** ç³»çµ±æª¢æŸ¥ IndexedDB çš„ `templates` store æ˜¯å¦ç‚ºç©º
- **THEN** è‹¥ç‚ºç©ºï¼Œç³»çµ±å»ºç«‹ä»¥ä¸‹é è¨­æ¨¡æ¿ï¼š
  1. **æ¯æ—¥ç­†è¨˜** - æ¨™é¡Œ: "ç­†è¨˜ - {{date}}"ï¼ŒURL: ""
  2. **æœƒè­°è¨˜éŒ„** - æ¨™é¡Œ: "æœƒè­° #{{counter}} - {{date}}"ï¼ŒURL: ""
  3. **å¾…è¾¦äº‹é …** - æ¨™é¡Œ: "ä»»å‹™ #{{counter}}"ï¼ŒURL: ""
  4. **å­¸ç¿’è³‡æº** - æ¨™é¡Œ: "å­¸ç¿’ - {{date}}"ï¼ŒURL: ""
- **THEN** é è¨­æ¨¡æ¿æ¨™è¨˜ç‚º `isDefault: true`

#### Scenario: é‡ç½®ç‚ºé è¨­æ¨¡æ¿
- **GIVEN** ä½¿ç”¨è€…ä¿®æ”¹æˆ–åˆªé™¤äº†é è¨­æ¨¡æ¿
- **WHEN** ä½¿ç”¨è€…é»æ“Šã€Œé‡ç½®ç‚ºé è¨­æ¨¡æ¿ã€æŒ‰éˆ•
- **THEN** ç³»çµ±é¡¯ç¤ºç¢ºèªå°è©±æ¡†ï¼šã€Œæ­¤æ“ä½œå°‡æ¸…ç©ºæ‰€æœ‰æ¨¡æ¿ä¸¦é‡ç½®ç‚ºé è¨­ï¼Œç¢ºå®šç¹¼çºŒï¼Ÿã€
- **WHEN** ä½¿ç”¨è€…ç¢ºèª
- **THEN** ç³»çµ±æ¸…ç©º `templates` store
- **THEN** ç³»çµ±é‡æ–°å»ºç«‹é è¨­æ¨¡æ¿
- **THEN** é¡¯ç¤ºæˆåŠŸè¨Šæ¯ï¼šã€Œå·²é‡ç½®ç‚ºé è¨­æ¨¡æ¿ã€

#### Scenario: é è¨­æ¨¡æ¿å¯ç·¨è¼¯å’Œåˆªé™¤
- **GIVEN** ç³»çµ±åŒ…å«é è¨­æ¨¡æ¿
- **WHEN** ä½¿ç”¨è€…ç·¨è¼¯æˆ–åˆªé™¤é è¨­æ¨¡æ¿
- **THEN** ç³»çµ±å…è¨±è©²æ“ä½œï¼ˆé è¨­æ¨¡æ¿ä¸é–å®šï¼‰
- **THEN** ç·¨è¼¯å¾Œçš„æ¨¡æ¿ `isDefault` æ¬„ä½è®Šç‚º `false`

### Requirement: æ¨¡æ¿ä½¿ç”¨çµ±è¨ˆ
ç³»çµ±å¿…é ˆï¼ˆSHALLï¼‰è¿½è¹¤æ¨¡æ¿çš„ä½¿ç”¨æ¬¡æ•¸å’Œæœ€å¾Œä½¿ç”¨æ™‚é–“ã€‚

#### Scenario: è¨˜éŒ„æ¨¡æ¿ä½¿ç”¨æ¬¡æ•¸
- **GIVEN** æ¨¡æ¿ T çš„ `usageCount` ç‚º 5
- **WHEN** ä½¿ç”¨è€…å¾æ¨¡æ¿ T å»ºç«‹å¡ç‰‡
- **THEN** ç³»çµ±å°‡ `usageCount` æ›´æ–°ç‚º 6
- **THEN** ç³»çµ±æ›´æ–° `lastUsedAt` ç‚ºç•¶å‰æ™‚é–“æˆ³

#### Scenario: ä¾ä½¿ç”¨é »ç‡æ’åºæ¨¡æ¿
- **GIVEN** æ¨¡æ¿åˆ—è¡¨é¡¯ç¤º 10 å€‹æ¨¡æ¿
- **WHEN** ä½¿ç”¨è€…é¸æ“‡ã€Œä¾ä½¿ç”¨æ¬¡æ•¸æ’åºã€
- **THEN** æ¨¡æ¿æŒ‰ `usageCount` é™åºæ’åˆ—
- **THEN** æœ€å¸¸ç”¨çš„æ¨¡æ¿é¡¯ç¤ºåœ¨é ‚éƒ¨

#### Scenario: é¡¯ç¤ºæ¨¡æ¿ä½¿ç”¨çµ±è¨ˆ
- **GIVEN** æ¨¡æ¿ T çš„çµ±è¨ˆè³‡è¨Šï¼š
  - `usageCount`: 42
  - `lastUsedAt`: 2026-01-07 14:30:00
- **WHEN** ä½¿ç”¨è€…æª¢è¦–æ¨¡æ¿è©³æƒ…
- **THEN** ç³»çµ±é¡¯ç¤ºçµ±è¨ˆè³‡è¨Šï¼š
  - "å·²ä½¿ç”¨ 42 æ¬¡"
  - "æœ€å¾Œä½¿ç”¨ï¼š2026-01-07 14:30"

### Requirement: æ¨¡æ¿è®Šæ•¸æ“´å±•
ç³»çµ±å¿…é ˆï¼ˆSHALLï¼‰æ”¯æ´æ“´å±•è®Šæ•¸ç³»çµ±ï¼Œå…è¨±æœªä¾†æ–°å¢è‡ªè¨‚è®Šæ•¸ã€‚

#### Scenario: æ”¯æ´çš„å…§å»ºè®Šæ•¸åˆ—è¡¨
- **WHEN** ä½¿ç”¨è€…åœ¨æ¨¡æ¿ç·¨è¼¯å™¨ä¸­
- **THEN** ç³»çµ±æä¾›è®Šæ•¸åƒè€ƒèªªæ˜ï¼š
  - `{{date}}` - ç•¶å‰æ—¥æœŸï¼ˆYYYY-MM-DDï¼‰
  - `{{date:FORMAT}}` - è‡ªè¨‚æ ¼å¼æ—¥æœŸ
  - `{{datetime}}` - ç•¶å‰æ—¥æœŸæ™‚é–“ï¼ˆYYYY-MM-DD HH:mm:ssï¼‰
  - `{{time}}` - ç•¶å‰æ™‚é–“ï¼ˆHH:mm:ssï¼‰
  - `{{counter}}` - è‡ªå‹•éå¢è¨ˆæ•¸å™¨
  - `{{year}}` - ç•¶å‰å¹´ä»½
  - `{{month}}` - ç•¶å‰æœˆä»½
  - `{{day}}` - ç•¶å‰æ—¥æœŸï¼ˆæ•¸å­—ï¼‰

#### Scenario: è®Šæ•¸æ ¼å¼é©—è­‰
- **GIVEN** ä½¿ç”¨è€…åœ¨æ¨¡æ¿ä¸­è¼¸å…¥ `{{date:INVALID}}`
- **WHEN** ä½¿ç”¨è€…å„²å­˜æ¨¡æ¿
- **THEN** ç³»çµ±é¡¯ç¤ºè­¦å‘Šï¼šã€Œæ—¥æœŸæ ¼å¼ 'INVALID' ç„¡æ•ˆï¼Œå°‡ä½¿ç”¨é è¨­æ ¼å¼ã€
- **THEN** å…è¨±å„²å­˜æ¨¡æ¿ï¼ˆä¸é˜»æ“‹ï¼‰

#### Scenario: æœªä¾†æ”¯æ´è‡ªè¨‚è®Šæ•¸ï¼ˆè¨­è¨ˆé ç•™ï¼‰
- **è¨­è¨ˆè€ƒé‡**ï¼šæ¶æ§‹æ”¯æ´è¨»å†Šè‡ªè¨‚è®Šæ•¸è™•ç†å™¨
- **ç¯„ä¾‹**ï¼š
  ```typescript
  registerVariable('projectName', () => getProjectName());
  // ä½¿ç”¨: {{projectName}}
  ```

## Related Documentation
- **æŠ€è¡“è¨­è¨ˆ**: `design.md` - æ¨¡æ¿è®Šæ•¸ç³»çµ±èˆ‡å„²å­˜æ©Ÿåˆ¶
- **è³‡æ–™æ ¼å¼**: `/docs/specs/data-format.md` - TemplateData çµæ§‹
- **å¯¦ä½œä½ç½®**: `src/app/providers/TemplatesProvider.tsx` - ä¸»è¦å¯¦ä½œ
- **ç›¸é—œè¦æ ¼**: `../bookmark-management/spec.md` - å¡ç‰‡å»ºç«‹æ©Ÿåˆ¶
